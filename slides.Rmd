---
title: "R Markdown"
author: "Maurits Evers, Sebastian Kurscheid"
date: "Version 1.0 (`r format(Sys.time(), '%d %B %Y')`)"
output:
  ioslides_presentation:
    widescreen: true
    smaller: true
    fig_width: 10.5
    fig_height: 5.5
    fig_caption: false
#    df_print: paged
    toc: yes
#    incremental: true
    css: styles.css
---

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  CommonHTML: {
    scale: 130
  }
});
</script>

<style>
  .col2 {
    columns: 2 200px;         /* number of columns and width in pixels*/
    -webkit-columns: 2 200px; /* chrome, safari */
    -moz-columns: 2 200px;    /* firefox */
  }
  .col3 {
    columns: 3 100px;
    -webkit-columns: 3 100px;
    -moz-columns: 3 100px;
  }
</style>


## Overview {.columns-2}

```{r echo=FALSE, out.width="450px"}
knitr::include_graphics("figures/RMarkdown_formats.png")
```


**What we will cover**

1. Prerequisities and how to get started
2. (R)Markdown 101
3. Customising R markdown elements and outputs
4. To interactivity and beyond!

<div class="boxed">Exercise and question sessions.</div>


# Prerequisities and how to get started


## Prerequisities 1

**What to know?**

1. Basic R skills
2. Basic Unix/Linux skills

**What to bring?**

1. Bring laptop
2. A GitHub account?


## Prerequisities 2

**Which R packages to install/load?**
```{r results="hide", message=FALSE, warning=FALSE}
pkg <- c("ggplot2", "rmarkdown", "knitr", "dplyr");
lapply(pkg, function(x) { if (!require(x, character.only = TRUE, quietly = TRUE)) {
  install.packages(x);
  require(x, quietly = TRUE)}
})
```

**What data to work with?**

We will use the `starwars` dataset from `dplyr`.
```{r}
head(starwars, n = 4);
```


## How to get started 1

**Create new R Markdown document in RStudio**

1. File $\rightarrow$ New File $\rightarrow$ R Markdown

```{r echo=FALSE, out.width="800px"}
knitr::include_graphics("figures/new_RMarkdown_doc_1.png")
```


## How to get started 2
<ol start="2">
<li> Specify output option

```{r echo=FALSE, out.width="500px"}
knitr::include_graphics("figures/new_RMarkdown_doc_2.png")
```

<li>Render

## <font color="forestgreen">**Exercise**</font> {#ex}
1. Create a new R Markdown document in RStudio.
2. Select PDF, HTML and Word as output option.
3. Render the Markdown document to the corresponding output formats.
4. Locate and open the final output file.


## Under the hood

**Document conversion**

1. Rmd -> PDF, HTML, Word uses `rmarkdown::render()` (`knitr::pandoc()` is deprecated)
2. `rmarkdown::render()` makes use of the universal document converter pandoc (installed as part of RStudio)

For example, pandoc will translate
```{md}
# Header
```
into the following output-specific lines:

1. For HTML output
    ```{HTML}
    <h1>Header</h1>
    ```
2. For $\LaTeX$ output
    ```{LATEX}
    \section{Header}
    ```

# (R) Markdown 101


## (R) Markdown 101

Beware the different Markdown flavours: GitHub, R Markdown, vanilla Markdown, ...

**Focus here on R Markdown.**

1. Headers
2. Emphasis: bold and italics
3. Lists: Ordered and unordered
4. Images and links
5. Blockquotes
6. Rules and line breaks

**More details:**

* [Markdown basics](http://rmarkdown.rstudio.com/authoring_basics.html)
* [R Markdown Cheat Sheet](https://www.rstudio.com/wp-content/uploads/2015/02/rmarkdown-cheatsheet.pdf)
* [Markdown Cheat Sheet](https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet)


## (R) Markdown 101 {.columns-2}

**Headers**
```markdown
# Header 1
## Header 2
### Header 3
#### Header 4
```

**Emphasis**
```markdown
*italic*, _italic_
**bold**, __bold__
```

**Lists**
```markdown
1. Level 1
    + Item 1
    + Item 2
2. Level 2
    + Item 3
    + Item 4
3. Level 3
```


**Images and links**
```markdown
![Alt text](URL)
[RStudio](https://www.rstudio.com/)
[email@email.com](mailto:email@email.com)
```

**Blockquote**
```markdown
> RStudio makes R easier to use. It includes a 
  code editor, debugging & visualization tools.
```

**Rules**
```markdown
----, ****
```

**Manual line breaks**  
End line with two or more whitespaces.
```markdown
Line 1 ends here,␣␣
line 2 start here.
```


## (R) Markdown 101 {.columns-2}

**Tables**  
Assemble list of words, and divide them with hyphens - (for the first row), and then separating each column with a pipe |.
```markdown
First Header | Second Header
------------ | -------------
Cell 1 | Cell 2
Cell 3 | cell 4
```

**Fenced code blocks**  
Lines wrapped within an environment with leading and tailing ```` ``` ```` are converted into a code block.  
An optional language identifier provides syntax highlighting.  

````markdown
```bash
echo "3 + 4"
```
````

R code blocks will be evaluated and printed (replace double with single curly brackets).

````markdown
```{{r}}
3 + 4
```
````

**Inline code**  
Use single backticks `` ` `` (delete curly brackets)
```markdown
`{r} summary(starwars)`
```


**Equations**  
The power of $\LaTeX$
```markdown
$x = a$
$$ int_{x=0}^\infty dx \log{1+x} $$
```


## <font color="forestgreen">Exercise</font> {#ex}

1. Experiment with different markdown elements in your markdown document
2. Render the document and check the resulting output file
3. Are there any specific text elements you would like to typeset?


## (R) Markdown 101: Images

More options to include to include external images/figures.

1. Use `![](path/to/image.png)`
2. Use HTML `<img src="path/to/image.png" style="width:200px;">`
3. Use `knitr::include_graphics`


# R Markdown elements


## R Markdown output

1. Word  
    [[http://rmarkdown.rstudio.com/word_document_format.html]](http://rmarkdown.rstudio.com/word_document_format.html)
2. PDF  
    [[http://rmarkdown.rstudio.com/pdf_document_format.html]](http://rmarkdown.rstudio.com/pdf_document_format.html)
3. HTML  
    [[http://rmarkdown.rstudio.com/html_document_format.html]](http://rmarkdown.rstudio.com/html_document_format.html)
4. Presentation (HTML, $\LaTeX$ beamer)

<div class="boxed">
**Exercise:** Create different output documents in RStudio
</div>


## The YAML header

```{YAML}
---
title: "Main title"
subtitle: "Subtitle"
author: "Firstname Lastname"
date: "07/08/2017"
output:
  word_document
---
```

**Main keys**

1. Title and subtitle
2. Author (can have multiple authors as list for key `author`)
3. Date (can be R code, e.g. `format(Sys.time(), '%d %B %Y')`)
4. Output option: `html_document`, `pdf_document`, `word_document`, `ioslides_presentation`, `beamer_presentation`

<div class="boxed">
**Exercise:** Change the title/author/date/output fields of your Rmd document.
</div>


## Controlling the R output: Code chunk options

**Some useful options**

- `eval=FALSE`: Don't run code.
- `include=FALSE`: Run code but don't include the chunk in the output document.
- `echo=FALSE`: Don't show code, show results.
- `results='hide'`: Show code, don't show results.
- `message=FALSE`: Don't show any additional R messages.
- `error=FALSE`: Don't show R error messages.
- `warning=FALSE`: Don't show R warning messages.
- `cache=TRUE`: Use cached results (if available) until the code chunk is changed.
- `fig.width=7, fig.height=7`: Set figure width and height to 7 inches.

More chunk options can be found in e.g. the [R Markdown Reference Guide](https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf).

<div class="boxed">
**Exercise:** Experiment with different code options: Disable output, results, and code evaluation.
</div>


## Tables

1. General: How to output tables/dataframes?
2. `knitr::kable()`
3. `tibble::print.tbl_df()`
4. `DT::datatable()`

<div class="boxed">
**Excercise:** Output a table, and use different layout options.
</div>


## Tables: `knitr::kable()`

```{r}
suppressMessages(library(knitr));
kable(starwars[1:4, 1:4])
```


## Tables: `DT::datatable()`

```{r}
suppressMessages(library(DT));
#DT::datatable(starwars, options = list(dom = "ftp", scrollX = TRUE, pageLength = 4));
DT::datatable(starwars[, 1:4], options = list(pageLength = 8));
```


## Interactive plots

1. plotly
2. D3 in R

**Load the necessary libraries**
```{r}
suppressMessages(library(ggplot2));
suppressMessages(library(plotly));
suppressMessages(library(scatterD3));
```


## Interactive plots: `plotly::ggplotly()`

```{r}
ggplotly(ggplot(starwars, aes(x = height, y = mass, label = name)) + geom_point(), height = 5);
```


## Interactive plots: `scatterD3::scatterD3()`

```{r, fig.height=4.5, fig.width=10}
scatterD3(x = starwars$height, y = starwars$mass, lab = starwars$name);
```


## Beyond interactive plots

R Markdown and shiny


## Link with github

...